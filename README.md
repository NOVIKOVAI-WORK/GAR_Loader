# Bash скрипт для загрузки дельты ГАР ФИАС
- ресурс https://fias.nalog.ru/Updates

# Важно!
- Если в логе gar_download.log обнаружена запись STATUS ERROR, необходимо удалить ее через запуск в ручном режиме '-m' или в ручную через редакторы (например Vi)
- Перед запуском скрипта выдайте права на запуск командой chmod +x ./gar_download_script

# Настройки по умолчанию (переменные)
- gar_dir="/usr/sap/tmp/GAR" - директория для загруки дельты справоника ГАР
- gar_script_dir="/usr/sap/tmp/GAR_LOADER" - директория исполняемого скрипта
- date=$(date +%d.%m.%Y\ %H:%M:%S) - текущая дата и время
- url="https://fias-file.nalog.ru/downloads/${date}/gar_delta_xml.zip" ссылка на ресурс с дельтой, где ${date} текущая дата
- log_file="gar_download.log" - файл лога, по умолчанию пишется в директорию расположения исполняемого скрипта /usr/sap/tmp/GAR_LOADER
- sid=SYSTEM SID - SID системы
- addr=MAIL@MAIL.com - e-mail, куда будет направлено оповещение о ошибочном выполнении скрипта
- subj_error="$sid GAR DOWNLOAD FAILED!" - тема письма 

# Ключи запуска скрипта
- -a - запуск в автоматическом режиме, берется текущая дата, если на текущую дату не найдена дельта, пишется лог STATUS ERROR
- -m - запуск в ручном режиме

| № шага | Описание                                          | Опция      |
|--------|---------------------------------------------------|------------|
| Шаг 1  | Удалить STATUS ERROR из лог файла?                | Да/Нет     |
| Шаг 2  | Хотите почистить содержимое директории GAR?       | Да/Нет     |
| Шаг 3  | Вы хотите загрузить архив с дельтой ГАР?          | Да/Нет     |
| Шаг 4  | Укажите дату опубликованной дельты для загрузки   | YYYY.MM.DD |

Если возникли вопросы можете обращаться на почту andreynovikov_work@mail.ru